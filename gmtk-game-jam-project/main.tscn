[gd_scene load_steps=66 format=3 uid="uid://d0ha2oack7o3e"]

[ext_resource type="Script" path="res://main.gd" id="1_7an7p"]
[ext_resource type="PackedScene" path="res://Scenes/tower.tscn" id="1_vyirh"]
[ext_resource type="Script" path="res://Scripts/game_manager.gd" id="2_53yhx"]
[ext_resource type="Script" path="res://Scripts/game_mgmt/spawner.gd" id="4_kkvm3"]
[ext_resource type="Script" path="res://Scripts/game_mgmt/inventory.gd" id="5_bhk52"]
[ext_resource type="Texture2D" uid="uid://bg5sju7pyil7" path="res://Visual/UI/Монетки.png" id="6_a1i2i"]
[ext_resource type="FontFile" uid="uid://c18a4x8oe4gie" path="res://Visual/Alice in Wonderland.ttf" id="6_rhh1s"]
[ext_resource type="Texture2D" uid="uid://dtnwnqe1ng4rx" path="res://Visual/Backgrounds/Задник.png" id="7_djedb"]
[ext_resource type="Texture2D" uid="uid://c8t2iuciwksii" path="res://Visual/Screens/Ветер6.png" id="7_xeqyv"]
[ext_resource type="Texture2D" uid="uid://b8cxytnwf2e1y" path="res://Visual/Screens/tuman1.png" id="8_cv15u"]
[ext_resource type="Texture2D" uid="uid://c06x8ufn3csv4" path="res://Visual/Screens/Ветер1.png" id="8_qmcxi"]
[ext_resource type="Texture2D" uid="uid://cxpahns8eiwb1" path="res://Visual/Screens/tuman2.png" id="9_nfmgy"]
[ext_resource type="Texture2D" uid="uid://bmgfape2jorki" path="res://Visual/Screens/Ветер2.png" id="9_ryh1b"]
[ext_resource type="Texture2D" uid="uid://bmc54i5ckp57h" path="res://Visual/Screens/tuman3.png" id="10_46ot1"]
[ext_resource type="Texture2D" uid="uid://bkabfumkixux8" path="res://Visual/Screens/Ветер3.png" id="10_jy2cl"]
[ext_resource type="Texture2D" uid="uid://ckk5a4d5anus1" path="res://Visual/Screens/Ветер4.png" id="11_oec58"]
[ext_resource type="Texture2D" uid="uid://bhwc0rfgh3bjb" path="res://Visual/Screens/tuman4.png" id="11_yid8x"]
[ext_resource type="Texture2D" uid="uid://dfjm5jvrl1egt" path="res://Visual/Screens/Ветер5.png" id="12_c7e7a"]
[ext_resource type="Texture2D" uid="uid://qdpjc1ytmua0" path="res://Visual/Screens/tuman5.png" id="12_dirie"]
[ext_resource type="Texture2D" uid="uid://58snx4h07vxj" path="res://Visual/Screens/tuman6.png" id="13_lhnfk"]
[ext_resource type="Script" path="res://weather.gd" id="14_gljpk"]
[ext_resource type="Texture2D" uid="uid://d0g3m10jx8fq0" path="res://Visual/Screens/tuman7.png" id="14_nwevj"]
[ext_resource type="Texture2D" uid="uid://elmo5koikn2f" path="res://Visual/Screens/Дождь1.png" id="14_v0a40"]
[ext_resource type="Texture2D" uid="uid://bnf1ifjc4u0tc" path="res://Visual/Screens/tuman8.png" id="15_1vv7b"]
[ext_resource type="Texture2D" uid="uid://b50fpx31aepch" path="res://Visual/Screens/Дождь2.png" id="15_mk5sk"]
[ext_resource type="Texture2D" uid="uid://b7xsbdj3617vn" path="res://Visual/Screens/Дождь3.png" id="16_aymgt"]
[ext_resource type="Texture2D" uid="uid://cspmwemk6y1rj" path="res://Visual/Screens/Дождь4.png" id="17_o2wer"]
[ext_resource type="Texture2D" uid="uid://ii4wvvlf37by" path="res://Visual/Screens/Снег1.png" id="18_pxvee"]
[ext_resource type="Texture2D" uid="uid://cgpe6h6rolfmi" path="res://Visual/Screens/Снег2.png" id="19_ln2m3"]
[ext_resource type="Texture2D" uid="uid://dwga18nnb5v7y" path="res://Visual/Screens/Снег3.png" id="20_0cgpw"]
[ext_resource type="Texture2D" uid="uid://cs62doia1gfee" path="res://Visual/Screens/Снег4.png" id="21_3baj4"]
[ext_resource type="Texture2D" uid="uid://7mfj1y564rc3" path="res://Visual/Screens/Туман1.png" id="22_mih06"]
[ext_resource type="Texture2D" uid="uid://isx5ak8indxs" path="res://Visual/Screens/Катсцена2 1.png" id="33_7jmd1"]
[ext_resource type="Texture2D" uid="uid://w4pfo4qg4y5h" path="res://Visual/Screens/Проигрыш.png" id="33_hhdu0"]
[ext_resource type="Texture2D" uid="uid://sqkdhm1kip0c" path="res://Visual/Screens/Катсцена1 1.png" id="33_tsjs1"]
[ext_resource type="Texture2D" uid="uid://bxhhtjshlh26p" path="res://Visual/Screens/Катсцена2 2.png" id="34_adgc1"]
[ext_resource type="Texture2D" uid="uid://c2lprq7e2hgm2" path="res://Visual/Screens/Катсцена1 2.png" id="34_i2onw"]
[ext_resource type="Texture2D" uid="uid://d1qgwkvl0u2sm" path="res://Visual/Screens/Катсцена2 3.png" id="35_5x56o"]
[ext_resource type="Texture2D" uid="uid://btsd0t2rkekc4" path="res://Visual/Screens/Катсцена1 3.png" id="35_dy52x"]
[ext_resource type="Texture2D" uid="uid://blggpp3ll7vqk" path="res://Visual/Screens/Катсцена2 4.png" id="36_8yc78"]
[ext_resource type="Texture2D" uid="uid://xsjyhk1ptyna" path="res://Visual/Screens/Катсцена1 4.png" id="36_gr2uo"]
[ext_resource type="PackedScene" uid="uid://fqkic1nbxvpi" path="res://Scenes/Projectiles/Dragon.tscn" id="41_ao17e"]
[ext_resource type="AudioStream" uid="uid://betc3wca757hl" path="res://Audio/stemps/lev 7_2 - Track 1.wav" id="42_oa2fc"]
[ext_resource type="AudioStream" uid="uid://cuofx1glw6ebg" path="res://Audio/stemps/lev 7_2 - Track 2.wav" id="43_p5m3f"]
[ext_resource type="AudioStream" uid="uid://cn5re7ckpkqif" path="res://Audio/stemps/lev 7_2 - Track 12.wav" id="44_2n2q3"]
[ext_resource type="AudioStream" uid="uid://d1253gdnql547" path="res://Audio/stemps/lev 7_2 - Track 3.wav" id="44_32to7"]
[ext_resource type="Script" path="res://Scripts/game_mgmt/audio_stream_player.gd" id="45_0u4i0"]
[ext_resource type="AudioStream" uid="uid://tvbtyyiyvq0b" path="res://Audio/stemps/lev 7_2 - Track 13.wav" id="45_jhwxl"]
[ext_resource type="AudioStream" uid="uid://bgtsh7grohexi" path="res://Audio/stemps/lev 7_2 - Track 14.wav" id="46_k3kbq"]
[ext_resource type="AudioStream" uid="uid://chmtrcoixo7f" path="res://Audio/stemps/lev 7_2 - Track 15.wav" id="47_nfet4"]
[ext_resource type="AudioStream" uid="uid://dacg0mptk7uml" path="res://Audio/stemps/lev 7_2 - Track 16.wav" id="48_xw1pc"]
[ext_resource type="AudioStream" uid="uid://eid5iuvxw5nf" path="res://Audio/stemps/lev 7_2 - Track 17.wav" id="49_bb0li"]
[ext_resource type="AudioStream" uid="uid://cuvq051dxotlj" path="res://Audio/stemps/lev 7_2 - Track 19.wav" id="50_sqq4f"]
[ext_resource type="AudioStream" uid="uid://8iow01c8rjxa" path="res://Audio/stemps/lev 7_2 - Track 20.wav" id="51_uyu3a"]
[ext_resource type="AudioStream" uid="uid://jcgyl142mx5i" path="res://Audio/stemps/lev 7_2 - Track 4.wav" id="53_otgb4"]
[ext_resource type="AudioStream" uid="uid://d3jwiggnyput0" path="res://Audio/stemps/lev 7_2 - Track 5.wav" id="54_gdk15"]
[ext_resource type="AudioStream" uid="uid://dbgd3vybc6im7" path="res://Audio/stemps/lev 7_2 - Track 6.wav" id="55_d5657"]
[ext_resource type="AudioStream" uid="uid://cvpl8u8sgnwgt" path="res://Audio/stemps/lev 7_2 - Track 8.wav" id="56_sesrw"]
[ext_resource type="AudioStream" uid="uid://3cevq0q5t2lm" path="res://Audio/stemps/lev 7_2 - Track 9.wav" id="57_0nden"]
[ext_resource type="AudioStream" uid="uid://ctxhtidc1cr41" path="res://Audio/stemps/lev 7_2 - Track 10.wav" id="58_2jdxg"]
[ext_resource type="AudioStream" uid="uid://b1l3ex3kkf6w0" path="res://Audio/stemps/lev 7_2 - Track 11.wav" id="59_essit"]

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_yfavc"]

[sub_resource type="SpriteFrames" id="SpriteFrames_n30pi"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": null
}],
"loop": true,
"name": &"Nothing",
"speed": 1.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("8_cv15u")
}, {
"duration": 1.0,
"texture": ExtResource("9_nfmgy")
}, {
"duration": 1.0,
"texture": ExtResource("10_46ot1")
}, {
"duration": 1.0,
"texture": ExtResource("11_yid8x")
}, {
"duration": 1.0,
"texture": ExtResource("12_dirie")
}, {
"duration": 1.0,
"texture": ExtResource("13_lhnfk")
}, {
"duration": 1.0,
"texture": ExtResource("14_nwevj")
}, {
"duration": 1.0,
"texture": ExtResource("15_1vv7b")
}],
"loop": true,
"name": &"Tuman",
"speed": 4.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("7_xeqyv")
}, {
"duration": 1.0,
"texture": ExtResource("8_qmcxi")
}, {
"duration": 1.0,
"texture": ExtResource("9_ryh1b")
}, {
"duration": 1.0,
"texture": ExtResource("10_jy2cl")
}, {
"duration": 1.0,
"texture": ExtResource("11_oec58")
}, {
"duration": 1.0,
"texture": ExtResource("12_c7e7a")
}],
"loop": true,
"name": &"Ветер",
"speed": 6.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("14_v0a40")
}, {
"duration": 1.0,
"texture": ExtResource("15_mk5sk")
}, {
"duration": 1.0,
"texture": ExtResource("16_aymgt")
}, {
"duration": 1.0,
"texture": ExtResource("17_o2wer")
}],
"loop": true,
"name": &"Дождь",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("18_pxvee")
}, {
"duration": 1.0,
"texture": ExtResource("19_ln2m3")
}, {
"duration": 1.0,
"texture": ExtResource("20_0cgpw")
}, {
"duration": 1.0,
"texture": ExtResource("21_3baj4")
}],
"loop": true,
"name": &"Снег",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("22_mih06")
}],
"loop": true,
"name": &"Туман",
"speed": 2.0
}]

[sub_resource type="SpriteFrames" id="SpriteFrames_i1cw7"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("33_hhdu0")
}],
"loop": true,
"name": &"Death",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("33_7jmd1")
}, {
"duration": 1.0,
"texture": ExtResource("34_adgc1")
}, {
"duration": 1.0,
"texture": ExtResource("35_5x56o")
}, {
"duration": 1.0,
"texture": ExtResource("36_8yc78")
}],
"loop": true,
"name": &"End",
"speed": 1.0
}, {
"frames": [{
"duration": 4.0,
"texture": ExtResource("33_tsjs1")
}, {
"duration": 4.0,
"texture": ExtResource("34_i2onw")
}, {
"duration": 4.0,
"texture": ExtResource("35_dy52x")
}, {
"duration": 4.0,
"texture": ExtResource("36_gr2uo")
}],
"loop": false,
"name": &"Start",
"speed": 1.0
}]

[sub_resource type="AudioStreamSynchronized" id="AudioStreamSynchronized_dpjtx"]
stream_count = 18
stream_0/stream = ExtResource("42_oa2fc")
stream_0/volume = 0.0
stream_1/stream = ExtResource("43_p5m3f")
stream_1/volume = -60.0
stream_2/stream = ExtResource("44_32to7")
stream_2/volume = -60.0
stream_3/stream = ExtResource("53_otgb4")
stream_3/volume = -60.0
stream_4/stream = ExtResource("54_gdk15")
stream_4/volume = -60.0
stream_5/stream = ExtResource("55_d5657")
stream_5/volume = -60.0
stream_6/stream = ExtResource("56_sesrw")
stream_6/volume = -60.0
stream_7/stream = ExtResource("57_0nden")
stream_7/volume = -60.0
stream_8/stream = ExtResource("58_2jdxg")
stream_8/volume = -60.0
stream_9/stream = ExtResource("59_essit")
stream_9/volume = -60.0
stream_10/stream = ExtResource("44_2n2q3")
stream_10/volume = -60.0
stream_11/stream = ExtResource("45_jhwxl")
stream_11/volume = -60.0
stream_12/stream = ExtResource("46_k3kbq")
stream_12/volume = -60.0
stream_13/stream = ExtResource("47_nfet4")
stream_13/volume = -60.0
stream_14/stream = ExtResource("48_xw1pc")
stream_14/volume = -60.0
stream_15/stream = ExtResource("49_bb0li")
stream_15/volume = -60.0
stream_16/stream = ExtResource("50_sqq4f")
stream_16/volume = -60.0
stream_17/stream = ExtResource("51_uyu3a")
stream_17/volume = -60.0

[node name="World" type="Node2D" node_paths=PackedStringArray("left_spawner", "right_spawner", "health_label", "resource_label", "first_camera", "second_camera", "third_camera")]
script = ExtResource("1_7an7p")
left_spawner = NodePath("GameManager/Spawner/LeftSpawner")
right_spawner = NodePath("GameManager/Spawner/RightSpawner")
health_label = NodePath("UI/HealthLabel")
resource_label = NodePath("UI/ResourceLabel")
first_camera = NodePath("Cameras/Camera2D")
second_camera = NodePath("Cameras/Camera2D2")
third_camera = NodePath("Cameras/Camera2D3")

[node name="Floor" type="StaticBody2D" parent="."]
collision_mask = 255

[node name="CollisionShape2D" type="CollisionShape2D" parent="Floor"]
shape = SubResource("WorldBoundaryShape2D_yfavc")

[node name="Tower" parent="." instance=ExtResource("1_vyirh")]
level = 2

[node name="GameManager" type="Node2D" parent="."]
script = ExtResource("2_53yhx")

[node name="Spawner" type="Node2D" parent="GameManager" node_paths=PackedStringArray("TowerNode")]
script = ExtResource("4_kkvm3")
TowerNode = NodePath("../../Tower")

[node name="SpawnTimer" type="Timer" parent="GameManager/Spawner"]
wait_time = 5.0
autostart = true

[node name="LeftSpawner" type="Marker2D" parent="GameManager/Spawner"]
position = Vector2(-650, -46)

[node name="RightSpawner" type="Marker2D" parent="GameManager/Spawner"]
position = Vector2(650, -46)

[node name="Inventory" type="Node2D" parent="GameManager" node_paths=PackedStringArray("InventoryUIContainer")]
script = ExtResource("5_bhk52")
InventoryUIContainer = NodePath("InventoryUI")

[node name="InventoryUI" type="HBoxContainer" parent="GameManager/Inventory"]
z_index = 2
offset_left = -575.0
offset_top = -530.0
offset_right = -345.0
offset_bottom = -457.0

[node name="UI" type="Node2D" parent="."]

[node name="HealthLabel" type="RichTextLabel" parent="UI"]
self_modulate = Color(0, 0.505882, 0.101961, 1)
offset_left = 414.2
offset_top = -603.0
offset_right = 576.2
offset_bottom = -452.0
theme_override_fonts/normal_font = ExtResource("6_rhh1s")
theme_override_font_sizes/normal_font_size = 35
text = "Health"

[node name="RichTextLabel" type="RichTextLabel" parent="UI/HealthLabel"]
self_modulate = Color(0.8, 0, 0.101961, 1)
layout_mode = 0
offset_top = 36.0
offset_right = 162.0
offset_bottom = 82.0
theme_override_fonts/normal_font = ExtResource("6_rhh1s")
theme_override_font_sizes/normal_font_size = 35
text = "10"

[node name="RichTextLabel2" type="RichTextLabel" parent="UI/HealthLabel"]
self_modulate = Color(0.0588235, 0.0431373, 0.580392, 1)
layout_mode = 0
offset_top = 65.0
offset_right = 162.0
offset_bottom = 116.0
theme_override_fonts/normal_font = ExtResource("6_rhh1s")
theme_override_font_sizes/normal_font_size = 35
text = "10"

[node name="ResourceLabel" type="RichTextLabel" parent="UI"]
offset_left = -575.0
offset_top = -600.0
offset_right = -436.0
offset_bottom = -537.0

[node name="Sprite2D" type="Sprite2D" parent="UI/ResourceLabel"]
position = Vector2(36.18, 30.52)
texture = ExtResource("6_a1i2i")

[node name="RichTextLabel" type="RichTextLabel" parent="UI/ResourceLabel"]
self_modulate = Color(1, 0.772549, 0.14902, 1)
layout_mode = 0
offset_left = 72.0
offset_top = 5.0
offset_right = 152.0
offset_bottom = 56.0
theme_override_fonts/normal_font = ExtResource("6_rhh1s")
theme_override_font_sizes/normal_font_size = 42
text = "10"

[node name="Background" type="Sprite2D" parent="UI"]
z_index = -2
position = Vector2(0, -417.78)
texture = ExtResource("7_djedb")

[node name="Cameras" type="Node2D" parent="."]

[node name="Camera2D" type="Camera2D" parent="Cameras"]
position = Vector2(0, -276)

[node name="Camera2D2" type="Camera2D" parent="Cameras"]
position = Vector2(0, -370)
enabled = false
zoom = Vector2(0.755, 0.755)

[node name="Camera2D3" type="Camera2D" parent="Cameras"]
position = Vector2(0, -416)
enabled = false
zoom = Vector2(0.605, 0.605)

[node name="Weather" type="AnimatedSprite2D" parent="."]
visible = false
z_index = 1
position = Vector2(-0.999969, -411)
scale = Vector2(1.03021, 1)
sprite_frames = SubResource("SpriteFrames_n30pi")
animation = &"Туман"
script = ExtResource("14_gljpk")

[node name="Weather_timer" type="Timer" parent="Weather"]

[node name="Meteor_timer" type="Timer" parent="Weather"]

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
visible = false
position = Vector2(0, -418.145)
sprite_frames = SubResource("SpriteFrames_i1cw7")
animation = &"Death"

[node name="Dragon" parent="." instance=ExtResource("41_ao17e")]
visible = false
position = Vector2(-639, -426)

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = SubResource("AudioStreamSynchronized_dpjtx")
autoplay = true
script = ExtResource("45_0u4i0")

[connection signal="body_entered" from="Tower" to="." method="_on_tower_body_entered"]
[connection signal="timeout" from="GameManager/Spawner/SpawnTimer" to="GameManager" method="_on_spawn_timeout"]
[connection signal="finished" from="AudioStreamPlayer" to="AudioStreamPlayer" method="_on_finished"]
